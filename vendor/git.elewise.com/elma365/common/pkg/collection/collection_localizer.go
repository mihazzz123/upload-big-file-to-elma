// Code generated by localizer. DO NOT EDIT.

package collection

import (
	"bytes"
	"fmt"
	"git.elewise.com/elma365/common/pkg/i18n"
	"github.com/leonelquinteros/gotext"
	"github.com/pkg/errors"
)

func (entity Collection) ExtractPO(poCtxt *i18n.EntityPOContext) ([]byte, error) {
	res := &bytes.Buffer{}

	// Контекст сущности
	entityCtxt := &i18n.EntityPOContext{
		Name:   "collection",
		ID:     fmt.Sprintf("%s.%s", entity.Namespace, entity.Code),
		Parent: poCtxt,
	}
	_ = entityCtxt

	{
		// Генерация перевода для поля "Alias"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "alias",
			Parent: entityCtxt,
		}
		b, err := i18n.ExtractPO(entity.Alias, &fieldCtxt)
		if err != nil {
			return res.Bytes(), errors.WithStack(err)
		}
		_, err = res.Write(b)
		if err != nil {
			return res.Bytes(), errors.WithStack(err)
		}
	}

	{
		// Генерация перевода для поля "Name"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "name",
			Parent: entityCtxt,
		}
		b, err := i18n.ExtractPO(entity.Name, &fieldCtxt)
		if err != nil {
			return res.Bytes(), errors.WithStack(err)
		}
		_, err = res.Write(b)
		if err != nil {
			return res.Bytes(), errors.WithStack(err)
		}
	}

	{
		// Генерация перевода для поля "Fields"
		for _, value := range entity.Fields {
			{
				fieldCtxt := i18n.EntityPOContext{
					Name:   "fields",
					Parent: entityCtxt,
				}
				var v i18n.LocalizableEntity
				var ok bool
				v, ok = interface{}(value).(i18n.LocalizableEntity)
				if !ok {
					v, ok = interface{}(&value).(i18n.LocalizableEntity)
				}
				if ok {
					b, err := v.ExtractPO(&fieldCtxt)
					if err != nil {
						return res.Bytes(), errors.WithStack(err)
					}
					_, err = res.Write(b)
					if err != nil {
						return res.Bytes(), errors.WithStack(err)
					}
				}
			}
		}
	}

	{
		// Генерация перевода для поля "Permissions"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "permissions",
			Parent: entityCtxt,
		}
		var v i18n.LocalizableEntity
		var ok bool
		v, ok = interface{}(entity.Permissions).(i18n.LocalizableEntity)
		if !ok {
			v, ok = interface{}(&entity.Permissions).(i18n.LocalizableEntity)
		}
		if ok {
			b, err := v.ExtractPO(&fieldCtxt)
			if err != nil {
				return res.Bytes(), errors.WithStack(err)
			}
			_, err = res.Write(b)
			if err != nil {
				return res.Bytes(), errors.WithStack(err)
			}
		}
	}

	{
		// Генерация перевода для поля "CreatedAt"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "__createdAt",
			Parent: entityCtxt,
		}
		var v i18n.LocalizableEntity
		var ok bool
		v, ok = interface{}(entity.CreatedAt).(i18n.LocalizableEntity)
		if !ok {
			v, ok = interface{}(&entity.CreatedAt).(i18n.LocalizableEntity)
		}
		if ok {
			b, err := v.ExtractPO(&fieldCtxt)
			if err != nil {
				return res.Bytes(), errors.WithStack(err)
			}
			_, err = res.Write(b)
			if err != nil {
				return res.Bytes(), errors.WithStack(err)
			}
		}
	}

	{
		// Генерация перевода для поля "UpdatedAt"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "__updatedAt",
			Parent: entityCtxt,
		}
		var v i18n.LocalizableEntity
		var ok bool
		v, ok = interface{}(entity.UpdatedAt).(i18n.LocalizableEntity)
		if !ok {
			v, ok = interface{}(&entity.UpdatedAt).(i18n.LocalizableEntity)
		}
		if ok {
			b, err := v.ExtractPO(&fieldCtxt)
			if err != nil {
				return res.Bytes(), errors.WithStack(err)
			}
			_, err = res.Write(b)
			if err != nil {
				return res.Bytes(), errors.WithStack(err)
			}
		}
	}

	if entity.DeletedAt != nil {
		// Генерация перевода для поля "DeletedAt"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "__deletedAt",
			Parent: entityCtxt,
		}
		var v i18n.LocalizableEntity
		var ok bool
		v, ok = interface{}(entity.DeletedAt).(i18n.LocalizableEntity)
		if !ok {
			v, ok = interface{}(&entity.DeletedAt).(i18n.LocalizableEntity)
		}
		if ok {
			b, err := v.ExtractPO(&fieldCtxt)
			if err != nil {
				return res.Bytes(), errors.WithStack(err)
			}
			_, err = res.Write(b)
			if err != nil {
				return res.Bytes(), errors.WithStack(err)
			}
		}
	}
	return res.Bytes(), nil
}

func (entity *Collection) ApplyTranslation(poCtxt *i18n.EntityPOContext, translator gotext.Translator) {
	// Контекст сущности
	entityCtxt := &i18n.EntityPOContext{
		Name:   "collection",
		ID:     fmt.Sprintf("%s.%s", entity.Namespace, entity.Code),
		Parent: poCtxt,
	}
	_ = entityCtxt

	{
		if entity.Alias != "" {
			// Применяем перевод к полю "Alias"
			fieldCtxt := i18n.EntityPOContext{
				Name:   "alias",
				Parent: entityCtxt,
			}
			s := translator.GetC(entity.Alias, fieldCtxt.String())
			if s == "" || s == entity.Alias {
				s = translator.Get(entity.Alias)
			}
			if s != "" {
				entity.Alias = s
			}
		}
	}

	{
		if entity.Name != "" {
			// Применяем перевод к полю "Name"
			fieldCtxt := i18n.EntityPOContext{
				Name:   "name",
				Parent: entityCtxt,
			}
			s := translator.GetC(entity.Name, fieldCtxt.String())
			if s == "" || s == entity.Name {
				s = translator.Get(entity.Name)
			}
			if s != "" {
				entity.Name = s
			}
		}
	}

	{
		// Генерация перевода для поля "Fields"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "fields",
			Parent: entityCtxt,
		}
		for i, value := range entity.Fields {
			{
				var v i18n.LocalizableEntity
				var ok bool
				v, ok = interface{}(value).(i18n.LocalizableEntity)
				if !ok {
					v, ok = interface{}(&value).(i18n.LocalizableEntity)
				}
				if ok {
					v.ApplyTranslation(&fieldCtxt, translator)
				}
			}
			entity.Fields[i] = value
		}
	}

	{
		// Генерация перевода для поля "Permissions"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "permissions",
			Parent: entityCtxt,
		}
		var v i18n.LocalizableEntity
		var ok bool
		v, ok = interface{}(entity.Permissions).(i18n.LocalizableEntity)
		if !ok {
			v, ok = interface{}(&entity.Permissions).(i18n.LocalizableEntity)
		}
		if ok {
			v.ApplyTranslation(&fieldCtxt, translator)
		}
	}

	{
		// Генерация перевода для поля "CreatedAt"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "__createdAt",
			Parent: entityCtxt,
		}
		var v i18n.LocalizableEntity
		var ok bool
		v, ok = interface{}(entity.CreatedAt).(i18n.LocalizableEntity)
		if !ok {
			v, ok = interface{}(&entity.CreatedAt).(i18n.LocalizableEntity)
		}
		if ok {
			v.ApplyTranslation(&fieldCtxt, translator)
		}
	}

	{
		// Генерация перевода для поля "UpdatedAt"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "__updatedAt",
			Parent: entityCtxt,
		}
		var v i18n.LocalizableEntity
		var ok bool
		v, ok = interface{}(entity.UpdatedAt).(i18n.LocalizableEntity)
		if !ok {
			v, ok = interface{}(&entity.UpdatedAt).(i18n.LocalizableEntity)
		}
		if ok {
			v.ApplyTranslation(&fieldCtxt, translator)
		}
	}

	if entity.DeletedAt != nil {
		// Генерация перевода для поля "DeletedAt"
		fieldCtxt := i18n.EntityPOContext{
			Name:   "__deletedAt",
			Parent: entityCtxt,
		}
		var v i18n.LocalizableEntity
		var ok bool
		v, ok = interface{}(entity.DeletedAt).(i18n.LocalizableEntity)
		if !ok {
			v, ok = interface{}(&entity.DeletedAt).(i18n.LocalizableEntity)
		}
		if ok {
			v.ApplyTranslation(&fieldCtxt, translator)
		}
	}
}
