# server
`import "git.elewise.com/elma365/common/pkg/server"`

* [Overview](#pkg-overview)
* [Index](#pkg-index)

## <a name="pkg-overview">Overview</a>



## <a name="pkg-index">Index</a>
* [type Config](#Config)
* [type Server](#Server)
  * [func New(grpcServer *grpc.Server, httpServer *http.Server) *Server](#New)
  * [func (srv *Server) Serve(cfg Config) error](#Server.Serve)
  * [func (srv *Server) Stop(ctx context.Context)](#Server.Stop)
  * [func (srv *Server) WaitSig(timeout time.Duration)](#Server.WaitSig)


#### <a name="pkg-files">Package files</a>
[server.go](https://git.elewise.com/elma365/common/-/tree/develop/pkg/server/server.go)






## <a name="Config">type</a> [Config](https://git.elewise.com/elma365/common/-/tree/develop/pkg/server/server.go?s=1313:1435#L52)
``` go
type Config interface {
    Name() string
    GetBind() string
    GetGRPCBind() string
    GetHTTPBind() string
    GetCMUXBind() bool
}
```
Config конфигурация необходимая для запуска сервиса










## <a name="Server">type</a> [Server](https://git.elewise.com/elma365/common/-/tree/develop/pkg/server/server.go?s=851:1004#L33)
``` go
type Server struct {
    // contains filtered or unexported fields
}

```
Server — это обёртка над gRPC и HTTP серверами для запуска их на одном порту и корректной остановки







### <a name="New">func</a> [New](https://git.elewise.com/elma365/common/-/tree/develop/pkg/server/server.go?s=1054:1120#L43)
``` go
func New(grpcServer *grpc.Server, httpServer *http.Server) *Server
```
New создаёт новую обёртку





### <a name="Server.Serve">func</a> (\*Server) [Serve](https://git.elewise.com/elma365/common/-/tree/develop/pkg/server/server.go?s=1597:1639#L61)
``` go
func (srv *Server) Serve(cfg Config) error
```
Serve начинает слушать адрес из cfg.Bind, одновременно для обоих серверов в своих горутинах




### <a name="Server.Stop">func</a> (\*Server) [Stop](https://git.elewise.com/elma365/common/-/tree/develop/pkg/server/server.go?s=3653:3697#L148)
``` go
func (srv *Server) Stop(ctx context.Context)
```
Stop останавливает сервера с учётом завершения контекста




### <a name="Server.WaitSig">func</a> (\*Server) [WaitSig](https://git.elewise.com/elma365/common/-/tree/develop/pkg/server/server.go?s=4444:4493#L185)
``` go
func (srv *Server) WaitSig(timeout time.Duration)
```
WaitSig быстрый метод для сервисов в которых есть только gRPC сервис

Слушает SIGINT и SIGTERM, после чего завершается. При повторном сигнале
или по истечению таймаута делает force stop.







- - -
Generated by [godoc2md](https://github.com/Exa-Networks/godoc2md)
